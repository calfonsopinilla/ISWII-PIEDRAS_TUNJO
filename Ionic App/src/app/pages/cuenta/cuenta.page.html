<app-header titulo="Tu cuenta" tipo="menu"></app-header>

<ion-content [fullscreen] class="ion-padding">

  <ion-row class="margin-avatar" *ngIf="!updateUser && usuario">
    <ion-col size="12" class="ion-text-center">
      <img [src]="usuario.Icono_url | imgServer: 'avatar'" width="200px" />
    </ion-col>
  </ion-row>

  <app-avatar-selector *ngIf="updateUser && usuario" 
        [current]="usuario.Icono_url" (avatarSelected)="avatar = $event"></app-avatar-selector>

  <form [formGroup]="editForm" (ngSubmit)="onSubmit()" *ngIf="editForm">

    <ion-list *ngIf="!updateUser">
      <ion-list-header>
        <ion-label><strong>Tus datos personales</strong></ion-label>
      </ion-list-header>
      <ion-item>
        <ion-label position="fixed"><strong>Nombre</strong> </ion-label>
        <ion-label>{{ usuario.Nombre }}</ion-label>
      </ion-item>
      <ion-item>
        <ion-label position="fixed"><strong>Apellido</strong></ion-label>
        <ion-label>{{ usuario.Apellido }}</ion-label>
      </ion-item>
      <ion-item>
        <ion-label position="fixed"><strong>Correo</strong></ion-label>
        <ion-label>{{ usuario.CorreoElectronico }}</ion-label>
      </ion-item>
    </ion-list>

    <ion-list *ngIf="updateUser">
      <ion-list-header>
        <ion-label><strong>Actualiza tus datos</strong></ion-label>
      </ion-list-header>
  
      <ion-item>
        <ion-label position="floating">Nombre</ion-label>
        <ion-input type="text" formControlName="nombre"></ion-input>

        <span class="text-danger"
              *ngIf="nombre.touched && nombre.dirty && nombre.errors?.required">El nombre es requerido</span>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Apellido</ion-label>
        <ion-input type="text" formControlName="apellido"></ion-input>

        <span class="text-danger"
              *ngIf="apellido.touched && apellido.dirty && apellido.errors?.required">
              El apellido es requerido</span>
      </ion-item>
    </ion-list>

    <ion-button expand="full" class="btn-form" (click)="crearForm(); updateUser = true;" 
                *ngIf="!updateUser">Editar</ion-button>
    <ion-button expand="full" class="btn-form" type="submit" [disabled]="editForm.invalid" 
                *ngIf="updateUser">Actualizar</ion-button>
    <ion-button expand="full" color="light" 
                (click)="updateUser = false; avatar = undefined;"
                *ngIf="updateUser">Cancelar</ion-button>
  </form>

</ion-content>