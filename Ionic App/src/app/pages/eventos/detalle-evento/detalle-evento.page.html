<app-header titulo="Detalle Evento" tipo="back"></app-header>

<ion-content [fullscreen] class="ion-padding">

  <ion-card *ngIf="evento">

    <img src="http://piedrasdeltunjo.tk/images/getImage?tipo=evento&nombre={{ evento.ImagenesUrl }}" />
    <ion-card-header>
      <ion-card-subtitle>Fecha: {{ evento.Fecha | date: 'MMM d, y' }}</ion-card-subtitle>
      <ion-card-title>{{ evento.Nombre }}</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      {{ evento.Descripcion }}
    </ion-card-content>  

  </ion-card>

  <ion-list>

    <ion-list-header>
        Reseñas
    </ion-list-header>

    <div *ngIf="estado == false"> <!-- Crear Comentario -->
      <div class="comentario_usuario_cntr" *ngIf="usuario">
        <ion-avatar slot="start">
          <img src="http://piedrasdeltunjo.tk/images/getImage?tipo=avatar&nombre={{ usuario.Icono_url }}">
        </ion-avatar>
        <ion-label>
          <h2>{{ usuario.Nombre }} {{ usuario.Apellido }}</h2>      
          <form [formGroup]="formUser" (ngSubmit)="crearComentario()" *ngIf="formUser">
            <h5>
              Mi calificación:             
            </h5>
            <rating formControlName="Calificacion" readonly="false" size="small"></rating>
            <h5>Mi comentario:</h5>
            <ion-textarea color="dark" formControlName="Descripcion"></ion-textarea>
            <ion-button id="button-submit" type="submit">Comentar</ion-button>
          </form>      
        </ion-label>      
      </div>
    </div>

    <div *ngIf="estado == true"> <!-- Actualizar Comentario -->
      <div class="comentario_usuario_cntr" *ngIf="comentarioUsuario">
        <ion-avatar slot="start">
          <img src="http://piedrasdeltunjo.tk/images/getImage?tipo=avatar&nombre={{ comentarioUsuario.usuario.Icono_url }}">
        </ion-avatar>
        <ion-label>
          <h2>{{ comentarioUsuario.usuario.Nombre }} {{ comentarioUsuario.usuario.Apellido }}</h2>              
          <p>{{ comentarioUsuario.FechaPublicacion | date: 'MMM d, y'  }}</p>
          <form [formGroup]="formUser" (ngSubmit)="actualizarComentario()" *ngIf="formUser">        
            <h5>
              Mi calificación: 
              <span style="font-weight: normal;">{{ comentarioUsuario.calificacion }}/5</span>
            </h5>
            <rating formControlName="Calificacion" readonly="false" size="small"></rating>
            <h5>Mi comentario:</h5>
            <ion-textarea color="dark" formControlName="Descripcion" value="{{ comentarioUsuario.descripcion }}"></ion-textarea>
            <ion-button id="button-submit" type="submit">Actualizar</ion-button>
          </form>              
        </ion-label>        
      </div>  
    </div>    

    <ion-item *ngFor="let comentario of listaComentariosEvento">
        <ion-avatar slot="start">
            <img src="http://piedrasdeltunjo.tk/images/getImage?tipo=avatar&nombre={{ comentario.usuario.Icono_url }}">
        </ion-avatar>
        <ion-label>
          <ion-button style="float: right;" (click)="reportarComentario(comentario)">
            <ion-icon name="skull"></ion-icon>
          </ion-button>
          <h2 style="font-weight: bold;">{{ comentario.usuario.Nombre }} {{ comentario.usuario.Apellido }}</h2>                
          <p>
            <img src="../../../../assets/img/{{ comentario.calificacion }}-star.png" width="26%" style="margin-right: 6px;">
            {{ comentario.fechaPublicacion | date: 'MMM d, y'   }}
          </p>
          <p>{{ comentario.descripcion }}</p>
        </ion-label>
    </ion-item>

  </ion-list>

</ion-content>
